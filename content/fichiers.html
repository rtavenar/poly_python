

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Interaction avec des fichiers &#8212; Introduction Ã  Python</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RÃ©cupÃ©ration de donnÃ©es Ã  partir dâ€™API web" href="api.html" />
    <link rel="prev" title="Les dictionnaires" href="dict.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo_ur2.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Introduction Ã  Python</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="intro.html">Introduction</a>
  </li>
  <li class="">
    <a href="struct.html">Structures de donnÃ©es et structures de contrÃ´le</a>
  </li>
  <li class="">
    <a href="dates.html">Les dates</a>
  </li>
  <li class="">
    <a href="listes.html">Les listes</a>
  </li>
  <li class="">
    <a href="chaines.html">Les chaÃ®nes de caractÃ¨res</a>
  </li>
  <li class="">
    <a href="dict.html">Les dictionnaires</a>
  </li>
  <li class="active">
    <a href="">Interaction avec des fichiers</a>
  </li>
  <li class="">
    <a href="api.html">RÃ©cupÃ©ration de donnÃ©es Ã  partir dâ€™API web</a>
  </li>
  <li class="">
    <a href="test.html">Tester son code</a>
  </li>
  <li class="">
    <a href="conclusion.html">Conclusion</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">CorrigÃ© des exercices</p>
</li>
  <li class="">
    <a href="solutions.html">Toutes les solutions</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/content/fichiers.md"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.md</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Source interaction buttons -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#manipulation-de-fichiers-en-python-avec-le-module-os" class="nav-link">Manipulation de fichiers en Python avec le module os</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#lecture-et-ecriture-de-fichiers-textuels" class="nav-link">Lecture et Ã©criture de fichiers textuels</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#qu-est-ce-qu-un-fichier-textuel" class="nav-link">Quâ€™est-ce quâ€™un fichier textuel ?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#encodage-des-fichiers" class="nav-link">Encodage des fichiers</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#lecture-de-fichiers-textuels" class="nav-link">Lecture de fichiers textuels</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#fichiers-textuels-generiques" class="nav-link">Fichiers textuels gÃ©nÃ©riques</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#fichiers-comma-separated-values-csv" class="nav-link">Fichiers Comma-Separated Values (CSV)</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h5">
            <a href="#cas-des-fichiers-a-en-tete" class="nav-link">Cas des fichiers Ã  en-tÃªte</a>
        </li>
    
        <li class="nav-item toc-entry toc-h5">
            <a href="#un-peu-de-magie" class="nav-link">Un peu de magieâ€¦</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#fichiers-javascript-object-notation-json" class="nav-link">Fichiers JavaScript Object Notation (JSON)</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#ecriture-de-fichiers-textuels" class="nav-link">Ã‰criture de fichiers textuels</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#id2" class="nav-link">Fichiers textuels gÃ©nÃ©riques</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#fichiers-csv" class="nav-link">Fichiers CSV</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#fichiers-json" class="nav-link">Fichiers JSON</a>
        </li>
    
            </ul>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#bonus-utilisation-de-with" class="nav-link">Bonus : utilisation de with</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#exercices" class="nav-link">Exercices</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="interaction-avec-des-fichiers">
<h1>Interaction avec des fichiers<a class="headerlink" href="#interaction-avec-des-fichiers" title="Permalink to this headline">Â¶</a></h1>
<p>Dans ce chapitre, nous allons prÃ©senter des outils de manipulation de fichiers en Python.
Un fichier est une unitÃ© logique dâ€™informations placÃ©e sur une mÃ©moire secondaire (un disque dur, une clef USB, <em>etc.</em>).</p>
<p>Quand vous consultez une dossier Ã  lâ€™aide de votre gestionnaire de fichiers, ce dossier peut comprendre plusieurs fichiers.
En accÃ©dant depuis un programme Python au contenu de fichiers de donnÃ©es, on va pouvoir alimenter le programme avec des donnÃ©es provenant dâ€™un fichier de donnÃ©es indÃ©pendant du programme (et non plus seulement des donnÃ©es Ã©crites en dur dans le programmes ou saisies par lâ€™utilisateur directement).</p>
<div class="section" id="manipulation-de-fichiers-en-python-avec-le-module-os">
<h2>Manipulation de fichiers en Python avec le module <code class="docutils literal notranslate"><span class="pre">os</span></code><a class="headerlink" href="#manipulation-de-fichiers-en-python-avec-le-module-os" title="Permalink to this headline">Â¶</a></h2>
<p>Lorsque lâ€™on lit ou Ã©crit des fichiers, il est frÃ©quent de vouloir rÃ©pÃ©ter la mÃªme opÃ©ration sur plusieurs fichiers, par exemple sur tous les fichiers avec lâ€™extension <code class="docutils literal notranslate"><span class="pre">&quot;.txt&quot;</span></code> dâ€™un rÃ©pertoire donnÃ©.
Pour ce faire, on peut utiliser en Python le module <code class="docutils literal notranslate"><span class="pre">os</span></code> qui propose un certain nombre de fonctions standard de manipulation de fichiers.
On utilisera notamment la fonction <code class="docutils literal notranslate"><span class="pre">listdir</span></code> de ce module qui permet de lister lâ€™ensemble des fichiers et sous-rÃ©pertoires contenus dans un rÃ©pertoire donnÃ© :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="k">for</span> <span class="n">nom_fichier</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;donnees&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>machin.csv
truc.txt
</pre></div>
</div>
</div>
</div>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">listdir</span></code> peut prendre indiffÃ©remment un chemin absolu ou relatif (dans notre exemple, il sâ€™agit dâ€™un chemin relatif qui pointe sur le sous-rÃ©pertoire <code class="docutils literal notranslate"><span class="pre">&quot;donnees&quot;</span></code> contenu dans le rÃ©pertoire de travail courant du programme).</p>
<p>Si vous exÃ©cutez le code ci-dessus et que votre rÃ©pertoire <code class="docutils literal notranslate"><span class="pre">&quot;donnees&quot;</span></code> nâ€™est pas vide, vous remarquerez que le nom du fichier stockÃ© dans la variable <code class="docutils literal notranslate"><span class="pre">nom_fichier</span></code> ne contient pas le chemin vers ce fichier.
Or, si lâ€™on souhaite ensuite ouvrir ce fichier (que ce soit en lecture ou en Ã©criture), il faudra bien spÃ©cifier ce chemin.
Pour cela, on utilisera la syntaxe suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">repertoire</span> <span class="o">=</span> <span class="s2">&quot;donnees&quot;</span>
<span class="k">for</span> <span class="n">nom_fichier</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">repertoire</span><span class="p">):</span>
    <span class="n">nom_complet_fichier</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">repertoire</span><span class="p">,</span> <span class="n">nom_fichier</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nom_complet_fichier</span><span class="p">)</span>
    <span class="c1"># Ouverture et traitement du fichier dont le nom est contenu dans</span>
    <span class="c1"># nom_complet_fichier</span>
</pre></div>
</div>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">path.join</span></code> du module <code class="docutils literal notranslate"><span class="pre">os</span></code> permet dâ€™obtenir le chemin complet vers le fichier Ã  partir du nom du rÃ©pertoire dans lequel il se trouve et du nom du fichier isolÃ©.
Il est prÃ©fÃ©rable dâ€™utiliser cette fonction plutÃ´t que dâ€™effectuer la concatÃ©nation des chaÃ®nes de caractÃ¨res correspondantes car la forme des chemins complets dÃ©pend du systÃ¨me dâ€™exploitation utilisÃ©, ce que gÃ¨re intelligemment <code class="docutils literal notranslate"><span class="pre">path.join</span></code>.</p>
</div>
<div class="section" id="lecture-et-ecriture-de-fichiers-textuels">
<h2>Lecture et Ã©criture de fichiers textuels<a class="headerlink" href="#lecture-et-ecriture-de-fichiers-textuels" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="qu-est-ce-qu-un-fichier-textuel">
<h3>Quâ€™est-ce quâ€™un fichier textuel ?<a class="headerlink" href="#qu-est-ce-qu-un-fichier-textuel" title="Permalink to this headline">Â¶</a></h3>
<p>Dans ce qui suit, nous traiterons uniquement de la lecture de fichiers textuels.
Pour faire simple, nous appellerons dans ce qui suit â€œfichier textuelâ€ tout fichier dont le contenu est lisible en clair en ouvrant le fichier avec un Ã©diteur de fichiers bruts (comme Notepad++ sous windows, ou gedit sous linux).
Pour se faire une idÃ©e, nous pouvons (sous unix) utiliser la commande <code class="docutils literal notranslate"><span class="pre">head</span></code> qui permet dâ€™afficher le dÃ©but dâ€™un fichier :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!head entete.csv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>NOM;PRENOM;AGE
Lemarchand;John;23
Trias;Anne;
</pre></div>
</div>
</div>
</div>
<p>Et si lâ€™on avait cherchÃ© Ã  lire le contenu dâ€™un fichier non textuel, on aurait obtenu quelque chose du type :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!head /usr/bin/python
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<pre class="output stream literal-block">ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½H__PAGEZEROï¿½__TEXT__text__TEXTpï¿½pï¿½__stubs__TEXT0H0ï¿½__stub_helper__TEXTxï¿½xï¿½__cstring__TEXTï¿½__unwind_info__TEXTï¿½Hï¿½ï¿½__DATA_CONST__got__DATA_CONSTï¿½__DATA__la_symbol_ptr__DATA`__data__DATA` ` H__LINKEDIT0P0ï¿½K&quot;ï¿½000HP0ï¿½810p13Pï¿½2/usr/lib/dyldï¿½ï¿½9Eï¿½N?:ï¿½ï¿½ï¿½ï¿½ï¿½H2

,*}(ï¿½pX/System/Library/Frameworks/Python.framework/Versions/2.7/Python8d/usr/lib/libSystem.B.dylib&amp;h1)p14ï¿½GUHï¿½ï¿½Hï¿½ï¿½0ï¿½Eï¿½ï¿½}ï¿½Hï¿½uï¿½ï¿½uHï¿½Eï¿½Hï¿½Eï¿½Hï¿½Mï¿½Hï¿½Hï¿½Eï¿½Hï¿½Eï¿½Hï¿½ï¿½Hï¿½Eï¿½ï¿½~Hï¿½uï¿½Lï¿½Eï¿½Hï¿½OLï¿½1Ò‰ï¿½Hï¿½Ç‰Uï¿½Hï¿½ï¿½Hï¿½Mï¿½ï¿½Hï¿½Uï¿½Hï¿½5Dï¿½UÔ¿ï¿½Eï¿½Dï¿½ï¿½ï¿½Iï¿½UHï¿½ï¿½Hï¿½ï¿½PHï¿½ï¿½Hï¿½ï¿½Hï¿½uï¿½ï¿½!ï¿½ï¿½ï¿½Hï¿½Eï¿½ï¿½ï¿½Hï¿½}ï¿½ï¿½8Hï¿½Eï¿½Hï¿½Eï¿½H&lt;Hï¿½ï¿½ï¿½Hï¿½Eï¿½Hï¿½}ï¿½ï¿½Hï¿½Eï¿½ï¿½Hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½}ï¿½Hï¿½uï¿½ï¿½Hï¿½Mï¿½HMï¿½Hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½Mï¿½1ï¿½Hï¿½Mï¿½H;Mï¿½ï¿½Eï¿½ï¿½Hï¿½Eï¿½ï¿½ï¿½ï¿½/ï¿½ÂˆUï¿½ï¿½Eï¿½ï¿½ï¿½ï¿½Hï¿½Eï¿½Hï¿½ï¿½ï¿½ï¿½Hï¿½Eï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½Eï¿½HHï¿½Eï¿½Hï¿½Eï¿½ï¿½ï¿½ï¿½.ï¿½Hï¿½Eï¿½HHï¿½Eï¿½Hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½}ï¿½Hï¿½5ï¿½ï¿½Hï¿½Mï¿½Hï¿½Mï¿½Hï¿½Eï¿½Hï¿½ï¿½P]ï¿½fï¿½UHï¿½ï¿½Hï¿½ï¿½0Hï¿½}ï¿½fï¿½Eï¿½Hï¿½}ï¿½ï¿½ï¿½Eï¿½ï¿½ï¿½ï¿½MØ‰ï¿½ï¿½ï¿½Hï¿½5ï¿½1ï¿½ï¿½ï¿½ï¿½Hï¿½Uï¿½Hï¿½Eï¿½ï¿½Eï¿½Hï¿½}ï¿½Hï¿½uï¿½Hï¿½Mï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½5ï¿½1ï¿½ï¿½ï¿½Hï¿½Eï¿½H;Eï¿½ï¿½'Hï¿½?Hï¿½8Hï¿½5ï¿½1Éˆï¿½ï¿½rï¿½ï¿½Eï¿½ï¿½_ï¿½Eï¿½ï¿½&#64;fï¿½Eï¿½Hï¿½}ï¿½ï¿½uï¿½ï¿½kï¿½Eï¿½ï¿½'ï¿½MĞ‰ï¿½ï¿½ï¿½Hï¿½5w1ï¿½ï¿½ï¿½Hï¿½ï¿½0]ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½ï¿½%ï¿½Lï¿½ï¿½ASï¿½%ï¿½ï¿½hï¿½ï¿½ï¿½ï¿½ï¿½hï¿½ï¿½ï¿½ï¿½ï¿½h#ï¿½ï¿½ï¿½ï¿½ï¿½h1ï¿½ï¿½ï¿½ï¿½ï¿½h&lt;ï¿½ï¿½ï¿½ï¿½hHï¿½ï¿½ï¿½ï¿½hWï¿½ï¿½ï¿½ï¿½heï¿½ï¿½ï¿½ï¿½hxï¿½ï¿½ï¿½ï¿½hï¿½ï¿½ï¿½ï¿½ï¿½hï¿½ï¿½ï¿½ï¿½ï¿½hï¿½ï¿½xï¿½ï¿½ï¿½posix_spawn: %sResources/Python.app/Contents/MacOS/Pythonposix_spawnattr_intposix_spawnattr_setbinprefposix_spawnattr_setbinpref failed to copy
posix_spawnattr_setflagsp4414ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½#\&#64;_Py_InitializeQrï¿½&#64;___stderrpï¿½&#64;_environï¿½&#64;dyld_stub_binderï¿½s&#64;___errorï¿½s&#64;___strcpy_chkï¿½s&#64;_dladdrï¿½s&#64;_errï¿½s &#64;_exitï¿½s(&#64;_fprintfï¿½s0&#64;_mallocï¿½s8&#64;_posix_spawnï¿½s&#64;&#64;_posix_spawnattr_initï¿½sH&#64;_posix_spawnattr_setbinpref_npï¿½sP&#64;_posix_spawnattr_setflagsï¿½sX&#64;_strlenï¿½__mh_execute_headerï¿½ï¿½ï¿½ï¿½&lt;BEa'0;IQZ_envï¿½ï¿½ï¿½ï¿½ï¿½	
	
__mh_execute_header_Py_Initialize___error___stderrp___strcpy_chk_dladdr_environ_err_exit_fprintf_malloc_posix_spawn_posix_spawnattr_init_posix_spawnattr_setbinpref_np_posix_spawnattr_setflags_strlendyld_stub_binderradr://5614542ï¿½ï¿½ï¿½5$&amp;jï¿½ï¿½ï¿½04
com.apple.python2zï¿½)ï¿½ï¿½ï¿½Å„1ï¿½Mï¿½pï¿½ï¿½ï¿½Lï¿½?ï¿½:tï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Eï¿½ï¿½ï¿½aHï¿½ï¿½ï¿½+Ö¬#ï¿½*9!Y%Iï¿½.Kï¿½}Ò­ï¿½ï¿½Xoï¿½ï¿½fï¿½ï¿½ï¿½ï¿½kOXï¿½|ï¿½|zï¿½Ú½ï¿½Hï¿½,ï¿½Wï¿½ï¿½rc{ï¿½NBlï¿½ï¿½'ï¿½ï¿½ï¿½3ï¿½ï¿½Pï¿½ï¿½&gt;A=Rï¿½&quot;oï¿½.ï¿½ï¿½&amp;[[vSï¿½ï¿½ï¿½ï¿½ï¿½ï¿½9ï¿½ï¿½ï¿½8ï¿½5oï¿½&lt;}ï¿½ï¿½ï¿½Dï¿½ï¿½0com.apple.python2ï¿½ï¿½ï¿½0ï¿½	*ï¿½Hï¿½ï¿½ï¿½ï¿½0ï¿½10	`ï¿½He0ï¿½	*ï¿½Hï¿½ï¿½ï¿½ï¿½0ï¿½0ï¿½ï¿½ï¿½!0	*ï¿½Hï¿½ï¿½0b10	UUS10U

Apple Inc.1&amp;0$UApple Certification Authority10UApple Root CA0111024173941Z261024173941Z010	UUS10U

</pre>
</div>
</div>
<p>En effet, le fichier situÃ© Ã  lâ€™adresse <code class="docutils literal notranslate"><span class="pre">/usr/bin/python</span></code> sur lâ€™ordinateur qui a gÃ©nÃ©rÃ© ce polycopiÃ© est un fichier binaire qui, sâ€™il contient bien des morceaux qui semblent correspondre Ã  du texte en clair, ne se rÃ©sume pas Ã  cela.</p>
<p>Dans ce chapitre, nous ne nous intÃ©ressons donc pas Ã  ce dernier type de fichiers mais nous nous concentrerons sur la lecture/Ã©criture de fichiers textuels par un programme Python.</p>
</div>
<div class="section" id="encodage-des-fichiers">
<h3>Encodage des fichiers<a class="headerlink" href="#encodage-des-fichiers" title="Permalink to this headline">Â¶</a></h3>
<p>Un premier Ã©lÃ©ment quâ€™il est nÃ©cessaire de maÃ®triser pour lire ou Ã©crire des fichiers textuels est la notion dâ€™encodage.
Il faut savoir quâ€™il existe plusieurs faÃ§ons dâ€™encoder un texte.
Nous nous focaliserons ici sur les deux encodages que vous Ãªtes les plus susceptibles de rencontrer (mais sachez quâ€™il en existe bien dâ€™autres) :</p>
<ul class="simple">
<li><p>lâ€™encodage Unicode 8 bits (UTF-8), dont le code en python est <code class="docutils literal notranslate"><span class="pre">&quot;utf-8&quot;</span></code> ;</p></li>
<li><p>lâ€™encodage Latin-1 (ISO-8859-1) dont le code en python est <code class="docutils literal notranslate"><span class="pre">&quot;iso-8859-1&quot;</span></code>.</p></li>
</ul>
<p>La principale diffÃ©rence entre ces deux encodage rÃ©side dans leur faÃ§on de coder les accents.
Ainsi, si le texte que vous lisez/Ã©crivez ne contient aucun accent ou caractÃ¨re spÃ©cial, il est probable que la question de lâ€™encodage ne soit pas problÃ©matique dans votre cas.
Au contraire, sâ€™il est possible que vous utilisiez de tels caractÃ¨res, il faudra bien faire attention Ã  lâ€™encodage utilisÃ©, que vous spÃ©cifierez Ã  lâ€™ouverture du fichier.
Si votre programme doit lire un fichier, il faudra donc vous assurer de lâ€™encodage associÃ© Ã  ce fichier (en lâ€™ouvrant par exemple avec un Ã©diteur de texte qui soit suffisamment avancÃ© pour vous fournir cette information).
Si vous Ã©crivez un programme qui Ã©crit un fichier, il faudra vous poser la question de lâ€™utilisation future qui sera faite de ce fichier : sâ€™il est amenÃ© Ã  Ãªtre ouvert par un autre utilisateur, il serait pertinent de vous demander quel encodage sera le moins problÃ©matique pour cet utilisateur, par exemple.</p>
<p>Si vous nâ€™avez pas de contrainte extÃ©rieure pour ce qui est de lâ€™encodage, vous utiliserez lâ€™encodage UTF-8 par dÃ©faut.</p>
</div>
<div class="section" id="lecture-de-fichiers-textuels">
<h3>Lecture de fichiers textuels<a class="headerlink" href="#lecture-de-fichiers-textuels" title="Permalink to this headline">Â¶</a></h3>
<p>Ce que nous appelons lecture de fichiers textuels en Python consiste Ã  copier le contenu dâ€™un fichier dans une (ou plusieurs) chaÃ®ne(s) de caractÃ¨res.
Cela implique deux Ã©tapes en Python :</p>
<ol class="simple">
<li><p>ouvrir le fichier en lecture ;</p></li>
<li><p>parcourir le contenu du fichier.</p></li>
</ol>
<p>La premiÃ¨re Ã©tape dâ€™ouverture du fichier en lecture est commune Ã  tous les types de fichiers textuels.
En supposant que le nom du fichier Ã  ouvrir soit stockÃ© sous forme de chaÃ®ne de caractÃ¨res dans la variable <code class="docutils literal notranslate"><span class="pre">nom_fichier</span></code>, le code suivant ouvre un fichier en lecture avec lâ€™encodage UTF-8 et stocke dans la variable <code class="docutils literal notranslate"><span class="pre">fp</span></code> un pointeur sur lâ€™endroit oÃ¹ nous sommes rendus dans notre lecture du fichier (pour lâ€™instant, le dÃ©but du fichier) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Le second argument (<code class="docutils literal notranslate"><span class="pre">&quot;r&quot;</span></code>) indique que le fichier doit Ãªtre ouvert en mode <em>read</em>, donc en lecture.</p>
<div class="section" id="fichiers-textuels-generiques">
<h4>Fichiers textuels gÃ©nÃ©riques<a class="headerlink" href="#fichiers-textuels-generiques" title="Permalink to this headline">Â¶</a></h4>
<p>Nous appelons ici â€œfichier textuel gÃ©nÃ©riqueâ€ un fichier dont le contenu nâ€™a pas de structure particuliÃ¨re (par opposition aux fichiers CSV ou JSON prÃ©sentÃ©s plus bas, par exemple).
Câ€™est le cas par exemple de fichiers contenant du texte libre.
Ces fichiers, une fois ouverts en lecture, peuvent Ãªtre lus ligne par ligne Ã  lâ€™aide de la boucle suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ligne</span> <span class="ow">in</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ligne</span><span class="p">)</span>
</pre></div>
</div>
<p>Ici, la variable <code class="docutils literal notranslate"><span class="pre">ligne</span></code>, de type chaÃ®ne de caractÃ¨res, contiendra successivement le texte de chacune des lignes du fichier considÃ©rÃ©.</p>
</div>
<div class="section" id="fichiers-comma-separated-values-csv">
<h4>Fichiers <em>Comma-Separated Values</em> (CSV)<a class="headerlink" href="#fichiers-comma-separated-values-csv" title="Permalink to this headline">Â¶</a></h4>
<p>Les fichiers <em>Comma-Separated Values</em> (CSV) permettent de stocker des donnÃ©es organisÃ©es sous la forme de tableaux dans des fichiers textuels.
Ã€ lâ€™origine, ces fichiers Ã©taient organisÃ©s par ligne et au sein de chaque ligne les cellules du tableau (correspondant aux diffÃ©rentes colonnes) Ã©taient sÃ©parÃ©es par des virgules (dâ€™oÃ¹ le nom de ce type de fichiers).
Aujourdâ€™hui, la dÃ©finition de ce format (<a class="reference external" href="https://tools.ietf.org/html/rfc4180">lien</a>) est plus gÃ©nÃ©rale que cela et diffÃ©rents dÃ©limiteurs sont acceptÃ©s.
Pour manipuler ces fichiers, il existe en Python un module dÃ©diÃ©, appelÃ© <code class="docutils literal notranslate"><span class="pre">csv</span></code>.
Ce module contient notamment une fonction <code class="docutils literal notranslate"><span class="pre">reader</span></code> permettant de simplifier la lecture de fichiers CSV.
La syntaxe dâ€™utilisation de cette fonction est la suivante (vous remarquerez la prÃ©sence de lâ€™attribut <code class="docutils literal notranslate"><span class="pre">delimiter</span></code>) :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>

<span class="n">nom_fichier</span> <span class="o">=</span> <span class="s2">&quot;simple.csv&quot;</span>

<span class="c1"># Contenu supposÃ© du fichier :</span>
<span class="c1"># 1;2;3;4;5</span>
<span class="c1"># a;b;c;d;e</span>
<span class="c1"># xx;xx;xx;xx;xx</span>
<span class="c1"># 0.4;0.5;0.7;0.8;0.9</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ligne</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cellule</span> <span class="ow">in</span> <span class="n">ligne</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cellule</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fin de ligne&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1
2
3
4
5
Fin de ligne
a
b
c
d
e
Fin de ligne
xx
xx
xx
xx
xx
Fin de ligne
0.4
0.5
0.7
0.8
0.9
Fin de ligne
</pre></div>
</div>
</div>
</div>
<p>On remarque ici que, contrairement au cas de fichiers textuels gÃ©nÃ©riques, la variable de boucle <code class="docutils literal notranslate"><span class="pre">ligne</span></code> nâ€™est plus une chaÃ®ne de caractÃ¨res mais une liste de chaÃ®nes de caractÃ¨res.
Les Ã©lÃ©ments de cette liste sont les cellules du tableau reprÃ©sentÃ© par le fichier CSV.</p>
<div class="section" id="cas-des-fichiers-a-en-tete">
<h5>Cas des fichiers Ã  en-tÃªte<a class="headerlink" href="#cas-des-fichiers-a-en-tete" title="Permalink to this headline">Â¶</a></h5>
<p>Souvent, les fichiers CSV comprennent une premiÃ¨re ligne dâ€™en-tÃªte, comme dans lâ€™exemple suivant :</p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>NOM;PRENOM;AGE
Lemarchand;John;23
Trias;Anne;
</pre></div>
</div>
<p>Si lâ€™on souhaite que, lors de la lecture du fichier CSV, chaque ligne soit reprÃ©sentÃ©e par un dictionnaire dont les clÃ©s sont les noms de colonnes (lus dans lâ€™en-tÃªte) et les valeurs associÃ©es sont celles lues dans la ligne courante, on utilisera <code class="docutils literal notranslate"><span class="pre">csv.DictReader</span></code> au lieu de <code class="docutils literal notranslate"><span class="pre">csv.reader</span></code> :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>

<span class="n">nom_fichier</span> <span class="o">=</span> <span class="s2">&quot;entete.csv&quot;</span>

<span class="c1"># Contenu supposÃ© du fichier :</span>
<span class="c1"># NOM;PRENOM;AGE</span>
<span class="c1"># Lemarchand;John;23</span>
<span class="c1"># Trias;Anne;</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ligne</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cle</span><span class="p">,</span> <span class="n">valeur</span> <span class="ow">in</span> <span class="n">ligne</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cle</span><span class="p">,</span> <span class="n">valeur</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--Fin de ligne--&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>NOM Lemarchand
PRENOM John
AGE 23
--Fin de ligne--
NOM Trias
PRENOM Anne
AGE 
--Fin de ligne--
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="un-peu-de-magie">
<h5>Un peu de magieâ€¦<a class="headerlink" href="#un-peu-de-magie" title="Permalink to this headline">Â¶</a></h5>
<p>Dans certains cas, on ne sait pas Ã  lâ€™avance quel dÃ©limiteur est utilisÃ© pour le fichier CSV Ã  lire. On peut demander au module CSV de deviner le <em>dialecte</em><a class="footnote-reference brackets" href="#dialect" id="id1">1</a> dâ€™un fichier en lisant le dÃ©but de ce fichier.
Dans ce cas, la lecture du fichier se fera en 4 Ã©tapes :</p>
<ol class="simple">
<li><p>Ouverture du fichier en lecture ;</p></li>
<li><p>Lecture des <em>n</em> premiers caractÃ¨res du fichier pour tenter de deviner son dialecte ;</p></li>
<li><p>â€œRembobinageâ€ du fichier pour recommencer la lecture au dÃ©but ;</p></li>
<li><p>Lecture du fichier en utilisant le dialecte dÃ©tectÃ© Ã  lâ€™Ã©tape 2.</p></li>
</ol>
<p>Le choix du paramÃ¨tre <em>n</em> doit Ãªtre un compromis : il faut lire suffisamment de caractÃ¨res pour que la dÃ©tection de dialecte soit fiable, tout en sachant que lire beaucoup de caractÃ¨res prendra du temps.
En pratique, lire les 1000 premiers caractÃ¨res dâ€™un fichier est souvent suffisant pour dÃ©terminer son dialecte.</p>
<p>On obtient alors une syntaxe du type :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>

<span class="n">nom_fichier</span> <span class="o">=</span> <span class="s2">&quot;simple.csv&quot;</span>

<span class="c1"># Contenu supposÃ© du fichier :</span>
<span class="c1"># 1,2,3</span>
<span class="c1"># a,b</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>  <span class="c1"># Ã‰tape 1.</span>
<span class="n">dialecte</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">Sniffer</span><span class="p">()</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>  <span class="c1"># Ã‰tape 2.</span>
<span class="n">fp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                                     <span class="c1"># Ã‰tape 3. Ã€ ne pas oublier !</span>
<span class="k">for</span> <span class="n">ligne</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">dialecte</span><span class="p">):</span> <span class="c1"># Ã‰tape 4.</span>
    <span class="k">for</span> <span class="n">cellule</span> <span class="ow">in</span> <span class="n">ligne</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cellule</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fin de ligne&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1
2
3
4
5
Fin de ligne
a
b
c
d
e
Fin de ligne
xx
xx
xx
xx
xx
Fin de ligne
0.4
0.5
0.7
0.8
0.9
Fin de ligne
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="fichiers-javascript-object-notation-json">
<h4>Fichiers <em>JavaScript Object Notation</em> (JSON)<a class="headerlink" href="#fichiers-javascript-object-notation-json" title="Permalink to this headline">Â¶</a></h4>
<p>Les fichiers <em>JavaScript Object Notation</em> (JSON) permettent de stocker des donnÃ©es structurÃ©es (par exemple avec une organisation hiÃ©rarchique). Un document JSON sâ€™apparente Ã  un dictionnaire en Python (Ã  la nuance prÃ¨s que les clÃ©s dâ€™un document JSON sont forcÃ©ment des chaÃ®nes de caractÃ¨res).
Voici un exemple de document JSON :</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;num_etudiant&quot;</span><span class="p">:</span> <span class="s2">&quot;21300000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;notes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
    <span class="nt">&quot;date_de_naissance&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;jour&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;mois&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;annee&quot;</span><span class="p">:</span> <span class="mi">1995</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>En Python, pour lire de tels fichiers, on dispose du module <code class="docutils literal notranslate"><span class="pre">json</span></code> qui contient une fonction <code class="docutils literal notranslate"><span class="pre">load</span></code> :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">nom_fichier</span> <span class="o">=</span> <span class="s2">&quot;simple.json&quot;</span>

<span class="c1"># Contenu supposÃ© du fichier :</span>
<span class="c1"># {</span>
<span class="c1">#    &quot;num_etudiant&quot;: &quot;21300000&quot;,</span>
<span class="c1">#    &quot;notes&quot;: [12, 5, 14],</span>
<span class="c1">#    &quot;date_de_naissance&quot;: {</span>
<span class="c1">#        &quot;jour&quot;: 1,</span>
<span class="c1">#        &quot;mois&quot;: 1,</span>
<span class="c1">#        &quot;annee&quot;: 1995</span>
<span class="c1">#    }</span>
<span class="c1"># }</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;num_etudiant&#39;: &#39;21300000&#39;, &#39;notes&#39;: [12, 5, 14], &#39;date_de_naissance&#39;: {&#39;jour&#39;: 1, &#39;mois&#39;: 1, &#39;annee&#39;: 1995}}
</pre></div>
</div>
</div>
</div>
<p>Il est Ã  noter quâ€™un fichier JSON peut Ã©galement contenir une liste de dictionnaires, comme dans lâ€™exemple suivant :</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span>
    <span class="nt">&quot;num_etudiant&quot;</span><span class="p">:</span> <span class="s2">&quot;21300000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;notes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
    <span class="nt">&quot;date_de_naissance&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;jour&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;mois&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;annee&quot;</span><span class="p">:</span> <span class="mi">1995</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="p">{</span>
    <span class="nt">&quot;num_etudiant&quot;</span><span class="p">:</span> <span class="s2">&quot;21300001&quot;</span><span class="p">,</span>
    <span class="nt">&quot;notes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">14</span><span class="p">],</span>
    <span class="nt">&quot;date_de_naissance&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;jour&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;mois&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="nt">&quot;annee&quot;</span><span class="p">:</span> <span class="mi">1989</span>
    <span class="p">}</span>
<span class="p">}]</span>
</pre></div>
</div>
<p>Dans ce cas, <code class="docutils literal notranslate"><span class="pre">json.load</span></code> retournera une liste de dictionnaires au lieu dâ€™un dictionnaire, bien Ã©videmment.</p>
<p>Enfin, si lâ€™on a stockÃ© dans une variable une chaÃ®ne de caractÃ¨res dont le contenu correspond Ã  un document JSON, on peut Ã©galement la transformer en dictionnaire (ou en liste de dictionnaires) Ã  lâ€™aide de la fonction <code class="docutils literal notranslate"><span class="pre">json.loads</span></code> (attention au â€œsâ€ final) :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ch</span> <span class="o">=</span> <span class="s1">&#39;{&quot;num_etudiant&quot;: &quot;21300000&quot;,  &quot;notes&quot;: [12, 5, 14]}&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>  <span class="c1"># loads : load (from) string</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;num_etudiant&#39;: &#39;21300000&#39;, &#39;notes&#39;: [12, 5, 14]}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="ecriture-de-fichiers-textuels">
<h3>Ã‰criture de fichiers textuels<a class="headerlink" href="#ecriture-de-fichiers-textuels" title="Permalink to this headline">Â¶</a></h3>
<p>Ce que nous appellons Ã©criture de fichiers textuels en Python consiste Ã  copier le contenu dâ€™une (ou plusieurs) chaÃ®ne(s) de caractÃ¨res dans un fichier.
Cela implique trois Ã©tapes en Python :</p>
<ol class="simple">
<li><p>ouvrir le fichier en Ã©criture ;</p></li>
<li><p>ajouter du contenu dans le fichier ;</p></li>
<li><p>fermer le fichier.</p></li>
</ol>
<p>La premiÃ¨re Ã©tape dâ€™ouverture du fichier en Ã©criture est commune Ã  tous les types de fichiers textuels.
En supposant que le nom du fichier Ã  ouvrir est stockÃ© sous forme de chaÃ®ne de caractÃ¨res dans la variable <code class="docutils literal notranslate"><span class="pre">nom_fichier</span></code>, le code suivant ouvre un fichier en Ã©criture avec lâ€™encodage UTF-8 et stocke dans la variable <code class="docutils literal notranslate"><span class="pre">fp</span></code> un pointeur sur lâ€™endroit oÃ¹ nous sommes rendus dans notre Ã©criture du fichier (pour lâ€™instant, le dÃ©but du fichier) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Le second argument (<code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code>) indique que le fichier doit Ãªtre ouvert en mode <em>write</em>, donc en Ã©criture.</p>
<p>Si le fichier en question existait dÃ©jÃ , son contenu est tout dâ€™abord Ã©crasÃ© et on repart dâ€™un fichier vide.
Si lâ€™on souhaite au contraire ajouter du texte Ã  la fin dâ€™un fichier existant, on utilisera le mode <em>append</em>, symbolisÃ© par la lettre <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Une fois les instructions dâ€™Ã©criture exÃ©cutÃ©es (voir plus bas), on doit fermer le fichier pour sâ€™assurer que lâ€™Ã©criture sera effective :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Il est Ã  noter que lâ€™on peut, dans certains cas, se dispenser de fermer explicitement le fichier.
Par exemple, si notre code est inclus dans un script Python, dÃ¨s la fin de lâ€™exÃ©cution du script, tous les fichiers ouverts en Ã©criture par le script sont automatiquement fermÃ©s.</p>
<div class="section" id="id2">
<h4>Fichiers textuels gÃ©nÃ©riques<a class="headerlink" href="#id2" title="Permalink to this headline">Â¶</a></h4>
<p>Pour ajouter du contenu Ã  un fichier pointÃ© par la variable <code class="docutils literal notranslate"><span class="pre">fp</span></code>, il suffit ensuite dâ€™utiliser la mÃ©thode <code class="docutils literal notranslate"><span class="pre">write</span></code> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;La vie est belle</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Notez que, contrairement Ã  la fonction <code class="docutils literal notranslate"><span class="pre">print</span></code> Ã  laquelle vous Ãªtes habituÃ©, la mÃ©thode <code class="docutils literal notranslate"><span class="pre">write</span></code> ne rajoute pas de caractÃ¨re de fin de ligne aprÃ¨s la chaÃ®ne de caractÃ¨res passÃ©e en argument, il faut donc inclure ce caractÃ¨re <code class="docutils literal notranslate"><span class="pre">&quot;\n&quot;</span></code> Ã  la fin de la chaÃ®ne de caractÃ¨res passÃ©e en argument, si vous souhaitez inclure un retour Ã  la ligne.</p>
</div>
<div class="section" id="fichiers-csv">
<h4>Fichiers CSV<a class="headerlink" href="#fichiers-csv" title="Permalink to this headline">Â¶</a></h4>
<p>Le module <code class="docutils literal notranslate"><span class="pre">csv</span></code> dÃ©jÃ  citÃ© plus haut contient Ã©galement une fonction <code class="docutils literal notranslate"><span class="pre">writer</span></code> permettant de simplifier lâ€™Ã©criture de fichiers CSV.
La syntaxe dâ€™utilisation de cette fonction est la suivante :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>

<span class="n">nom_fichier</span> <span class="o">=</span> <span class="s2">&quot;ecriture.csv&quot;</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">csvfp</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">csvfp</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">csvfp</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># AprÃ¨s cela, le fichier contiendra les lignes suivantes :</span>
<span class="c1"># 1;5;7</span>
<span class="c1"># 2;3</span>
</pre></div>
</div>
</div>
</div>
<p>La mÃ©thode <code class="docutils literal notranslate"><span class="pre">writerow</span></code> prend donc une liste en argument et Ã©crit dans le fichier les Ã©lÃ©ments de cette liste, sÃ©parÃ©s par le dÃ©limiteur <code class="docutils literal notranslate"><span class="pre">&quot;;&quot;</span></code> spÃ©cifiÃ© lors de lâ€™appel Ã  la fonction <code class="docutils literal notranslate"><span class="pre">writer</span></code>.
Le retour Ã  la ligne est Ã©crit directement par la mÃ©thode <code class="docutils literal notranslate"><span class="pre">writerow</span></code>, vous nâ€™avez pas Ã  vous en occuper.</p>
</div>
<div class="section" id="fichiers-json">
<h4>Fichiers JSON<a class="headerlink" href="#fichiers-json" title="Permalink to this headline">Â¶</a></h4>
<p>Le module <code class="docutils literal notranslate"><span class="pre">json</span></code> dÃ©jÃ  citÃ© plus haut contient Ã©galement une fonction <code class="docutils literal notranslate"><span class="pre">dump</span></code> permettant dâ€™Ã©crire le contenu dâ€™un dictionnaire (ou dâ€™une liste de dictionnaires) dans un fichier JSON.
La syntaxe dâ€™utilisation de cette fonction est la suivante :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">nom_fichier</span> <span class="o">=</span> <span class="s2">&quot;ecriture.json&quot;</span>

<span class="n">liste</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nom_fichier</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">liste</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># AprÃ¨s cela, le fichier contiendra la ligne suivante :</span>
<span class="c1"># [{&quot;a&quot;: 5}, {&quot;b&quot;: 3, &quot;a&quot;: 7}]</span>
</pre></div>
</div>
</div>
</div>
<p>Vous pouvez vous rÃ©fÃ©rer Ã  <a class="reference external" href="https://docs.python.org/fr/3/library/json.html#basic-usage">la documentation de cette fonction</a> pour maÃ®triser plus finement la mise en forme du contenu du fichier de sortie.</p>
</div>
</div>
</div>
<div class="section" id="bonus-utilisation-de-with">
<h2>Bonus : utilisation de <code class="docutils literal notranslate"><span class="pre">with</span></code><a class="headerlink" href="#bonus-utilisation-de-with" title="Permalink to this headline">Â¶</a></h2>
<p>Il existe en Python un moyen trÃ¨s efficace de maÃ®triser la durÃ©e de vie dâ€™une variable : il sâ€™agit de la directive <code class="docutils literal notranslate"><span class="pre">with</span></code>, dont la syntaxe est la suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">EXPRESSION</span> <span class="k">as</span> <span class="n">VARIABLE</span><span class="p">:</span>
    <span class="n">BLOC_DE_CODE</span>
</pre></div>
</div>
<p>Le code ci-dessus signifie que lâ€™on va crÃ©er une variable <code class="docutils literal notranslate"><span class="pre">VARIABLE</span></code> qui va stocker la valeur de retour de <code class="docutils literal notranslate"><span class="pre">EXPRESSION</span></code> (<a class="reference external" href="https://docs.python.org/2.5/whatsnew/pep-343.html">ceci nâ€™est pas tout Ã  fait exact</a>, mais dans lâ€™exemple qui nous intÃ©resse, cela revient au mÃªme), puis le code situÃ© dans <code class="docutils literal notranslate"><span class="pre">BLOC_DE_CODE</span></code> sera exÃ©cutÃ© et, Ã  la fin de ce bloc de code, <code class="docutils literal notranslate"><span class="pre">VARIABLE</span></code> sera dÃ©truite.</p>
<p>Cette syntaxe peut sâ€™avÃ©rer fort utile lorsque lâ€™on manipule des fichiers, parce que les pointeurs de fichiers, lorsquâ€™ils sont dÃ©truits, ferment automatiquement le fichier en question, et il nâ€™est donc pas nÃ©cessaire de faire appel Ã  la mÃ©thode <code class="docutils literal notranslate"><span class="pre">.close()</span></code> explicitement.</p>
<p>On pourra donc Ã©crire :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;simple.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">texte</span> <span class="ow">in</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">texte</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1;2;3;4;5

a;b;c;d;e

xx;xx;xx;xx;xx

0.4;0.5;0.7;0.8;0.9

</pre></div>
</div>
</div>
</div>
<p>et le fichier sera tout de mÃªme fermÃ© correctement dÃ¨s que lâ€™on sortira du bloc <code class="docutils literal notranslate"><span class="pre">with</span></code>.</p>
</div>
<div class="section" id="exercices">
<h2>Exercices<a class="headerlink" href="#exercices" title="Permalink to this headline">Â¶</a></h2>
<div class="admonition-exercice-7-1 admonition">
<p class="admonition-title"><strong>Exercice 7.1</strong></p>
<p>Ã‰crivez une fonction qui affiche, pour chaque fichier dâ€™extension <code class="docutils literal notranslate"><span class="pre">&quot;.txt&quot;</span></code> dâ€™un rÃ©pertoire passÃ© en argument, le nom du fichier ainsi que son nombre de lignes.</p>
<p>[<a class="reference internal" href="solutions.html#ex7-1-sol"><span class="std std-ref">CorrigÃ©</span></a>]</p>
</div>
<div class="admonition-exercice-7-2 admonition">
<p class="admonition-title"><strong>Exercice 7.2</strong></p>
<p>Ã‰crivez une fonction qui retourne le nombre de fichiers prÃ©sents dans un rÃ©pertoire dont le nom est passÃ© en argument.
Vous pourrez vous aider pour cela de la documentation du sous-module <code class="docutils literal notranslate"><span class="pre">path</span></code> du module <code class="docutils literal notranslate"><span class="pre">os</span></code> (<a class="reference external" href="https://docs.python.org/3.5/library/os.path.html">lien</a>).</p>
<p>[<a class="reference internal" href="solutions.html#ex7-2-sol"><span class="std std-ref">CorrigÃ©</span></a>]</p>
</div>
<hr class="docutils" />
<dl class="footnote brackets">
<dt class="label" id="dialect"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Le <em>dialecte</em> dâ€™un fichier CSV dÃ©finit, en fait, bien plus que le caractÃ¨re de sÃ©paration des cellules, comme dÃ©crit dans <a class="reference external" href="https://tools.ietf.org/html/rfc4180">ce document</a>.</p>
</dd>
</dl>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="dict.html" title="previous page">Les dictionnaires</a>
    <a class='right-next' id="next-link" href="api.html" title="next page">RÃ©cupÃ©ration de donnÃ©es Ã  partir dâ€™API web</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Romain Tavenard<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>